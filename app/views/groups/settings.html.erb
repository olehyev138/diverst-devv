<div class="content__main">
  <%= simple_form_for @group do |f| %>
    <div class="card">
      <div class="card__section card__section--border">
        <%= f.hidden_field :active, value: 0 %>
        <%= f.input :active, label: 'Allow users to join' %>

        <%= f.input :pending_users, input_html: { autofocus: true } %>
        <%= f.input :members_visibility %>
        <%= f.input :messages_visibility %>
        <%= f.input :latest_news_visibility %>
        <%= f.input :upcoming_events_visibility %>
        <%= f.label :banner, label: "Banner", input_html: { class: "field__label" } %>
        <% if @group.banner? %>
          <div class="flex-row__cell fright">
            <%= link_to "Remove", delete_attachment_group_path(@group), method: :patch, class: "error", data: { confirm: "Are you sure?" } %>
          </div>
        <% end %>
        <%= f.input :banner, as: :attachment_preview, label: false %>
        <%= f.input :calendar_color, input_html: { class: 'jscolor', autofocus: true } %>
        <h3>Sponsor Details</h3>
        <p>NOTE: Sponsor details are optional. However, if you wish to fill in this part, at least the sponsor name must be entered.</p>

         <%= f.simple_fields_for :sponsors do |s| %>
          <%= render 'sponsor_fields', f: s %>
        <% end %>

        <div class="group_sponsor_link">
          <%= link_to_add_association "Add a sponsor", f, :sponsors %>
        </div>
        <br>
        
        <%= f.input :yammer_group_link %>
      </div>
    </div>

    <%= f.button :submit %>
  <% end %>
</div>

<script>
  $(document).ready(function() {
   $(".group_sponsor_link").on('cocoon:before-insert', function() {
    var group_sponsors_count = $('.nested-fields').length
    if (group_sponsors_count == 3) {
      $(this).hide();
    }})
 });

</script>