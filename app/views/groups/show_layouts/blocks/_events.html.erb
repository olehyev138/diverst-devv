<% if GroupEventsPolicy.new(current_user, [@group]).view_upcoming_events? %>
  <%= link_to "View all", group_events_path(@group), class: "card__action" %>
  <% if !@upcoming_events.empty? %>
    <div class="mtlarge text-center">
      <% if !policy(@group).is_a_member? || !policy(Group).manage_all_groups? %>
        You have not joined any events yet.
      <% else %>
        <% @upcoming_events.each do |event| %>
          <%= render "shared/flippable/event", event: event %>
        <% end %>
      <% end %>
    </div>
  <% else %>
    <div class="mtlarge text-center">
      You are not a member of <%= @group.name %>.
    </div>
  <% end %>
<% end %>