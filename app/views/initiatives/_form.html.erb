<div class="content__main">
  <%= simple_form_for [@group, @initiative] do |f| %>

    <div class="card">
      <div class="card__section card__section--border">
        <p class="field__hint">Start off by choosing which <strong>program</strong> this event will participate in</p>
        <%= f.association :pillar, label_method: :name_with_group_prefix, label: false, include_blank: false %>
      </div>

      <div class="card__section card__section--border">
        <p class="field__hint">You may also specify <strong>participating groups</strong></p>
        <%= f.association :participating_groups, label: false, collection: current_user.enterprise.groups, input_html: {class: 'select2', multiple: true} %>
      </div>

      <div class="card__section card__section--border">
        <p class="field__hint">Give your event a <strong>name</strong></p>
        <%= f.input :name, label: false %>
      </div>

      <div class="card__section card__section--border">
        <p class="field__hint">Give it a short (or long) <strong>description</strong></p>
        <%= f.input :description, label: false %>
      </div>

      <div class="card__section card__section--border">
        <p class="field__hint">Define a <strong>start</strong> and <strong>end</strong> time</p>
        <%= f.input :start, label: false %>
        <%= f.input :end, label: false %>
      </div>

      <div class="card__section card__section--border">
        <button class='btn btn--primary' id='attach_budget_button'>Attach budget</button>
      </div>
      <div id='budget_panel' class="card_section row">
        <div class="col sm-6">
          <div class="card__section card__section--border">
            <p class="field__hint">Choose approved event from the list</strong>.
            </p>
            <%= f.input :associated_budget_id, collection: Budget.pre_approved_events_for_select(@group), label: false %>
          </div>
        </div>
        <div class="col sm-6">
          <div class="card__section card__section--border">
            <p class="field__hint">You can change <strong>estimated funding</strong>
            </p>
            <%= f.input :estimated_funding, label: false %>
          </div>
        </div>
      </div>

      <div class="row">
        <div class="col sm-4">
          <div class="card__section card__section--border">
            <p class="field__hint">Specify maximum <strong>attendees</strong></p>
            <%= f.input :max_attendees, label: false %>
          </div>
        </div>
        <div class="col sm-4">
          <div class="card__section card__section--border">
            <p class="field__hint">Specify the <strong>location</strong></p>
            <%= f.input :location, label: false %>
          </div>
        </div>
        <div class="col sm-4">
          <div class="card__section card__section--border">
            <%= f.input :picture, as: :file, lable: false %>
          </div>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="card__section card__section--border">
        <p>Define the <strong>metrics</strong> you want to track for this event</p>
      </div>
      <div id="fields">
        <%= f.simple_fields_for :fields do |field| %>
          <%= render 'field_fields', f: field %>
        <% end %>
      </div>

      <div class="link">
        <div class="card__section card__section--border">
          <%= link_to_add_association "+Add metric", f, :fields, wrap_object: Proc.new { NumericField.new } %>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="card__section card__section--border">
        <p>Define the <strong>TODO</strong> items associated with event.</p>
      </div>
      <div id="fields">
        <%= f.simple_fields_for :checklist_items do |item_form| %>
          <%= render 'checklists/item', f: item_form %>
        <% end %>
      </div>

      <div class="link">
        <div class="card__section card__section--border">
          <%= link_to_add_association "+Add TODO item", f, :checklist_items, partial: 'checklists/item' %>
        </div>
      </div>
    </div>

    <%= f.button :submit, 'Submit' %>
  <% end %>
</div>

<% content_for :page_scripts do %>
  <script>
    $('.select2').select2();

    $('#budget_panel').hide();

    $('#attach_budget_button').click(function(e){
      e.preventDefault();

      $('#budget_panel').slideToggle( "slow", function() {
          // Animation complete.
      });
    }); //endof click
  </script>
<% end %>