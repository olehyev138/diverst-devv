<h2>vCard</h2>

<%= simple_form_for resource, :as => resource_name, :url => invitation_path(resource_name), :html => { :method => :put } do |f| %>
  <%= devise_error_messages! %>
  <%= f.hidden_field :invitation_token %>

  <% resource.class.invite_key_fields.each do |field| -%>
    <%= f.input :email %>

    <br>

    <% resource.enterprise.fields.select(&:show_on_vcard).sort_by(&:gamification_value).each do |cf| %>
      <% if cf.is_a? TextField %>
        <%= f.input cf.title.downcase.to_sym, label: cf.title, as: :fake, input_html: { name: "custom-fields[#{cf.id}]", value: resource.info[cf.id] } %>
      <% elsif cf.is_a? SelectField %>
        <label><%= cf.title %></label>
        <select name="custom-fields[<%= cf.id %>]">
          <% cf.options.each do |fo| %>
            <option value="<%= fo.id %>" <%= "selected=selected" if resource.info[cf.id].to_i == fo.id %>><%= fo.title %></option>
          <% end %>
        </select>
      <% elsif cf.is_a? CheckboxField %>
        <div class="field">
          <label><%= cf.title %></label>
          <% cf.options.each do |fo| %>
            <%= check_box_tag "custom-fields[#{cf.id}][]", fo.id -%>
            <%= fo.title %>
          <% end %>
        </div>
      <% end %>
    <% end %>
  <% end -%>

  <br>

  <%= f.input :password %>
  <%= f.input :password_confirmation %>

  <%= f.submit "Create my account" %>
<% end %>
