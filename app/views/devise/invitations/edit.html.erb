<!DOCTYPE html>
<html>
<head>
  <title>Diverst</title>
  <%= stylesheet_link_tag (resource.enterprise.theme.nil? ? "application" : resource.enterprise.theme.asset_url), media: 'all', 'data-turbolinks-track' => true %>
  <%= javascript_include_tag 'application', 'data-turbolinks-track' => true %>
  <%= csrf_meta_tags %>
</head>
<body class="guest">
  <% if notice.present? %><p class="notice"><%= notice %></p><% end %>
  <% if alert.present? %><p class="alert"><%= alert %></p><% end %>

  <div class="site-wrap site-wrap--medium">
    <div class="content__header">
      <img class="logo logo--large" src="<%= (resource.enterprise.theme.nil? ? image_path('diverst-logo.svg') : resource.enterprise.theme.logo.expiring_url(10)) %>">
    </div>

    <div class="content__main">
      <div class="card">
        <div class="card__section">

          <div class="row">
            <div class="col sm-6 md-3 lg-5">
              <%= image_tag "cdo.jpg", class: "block", style: "width: 100%" %>
            </div>
            <div class="col sm-6 md-3 lg-7">
              <h3>Elva Lima, Director of Global D&I</h3>
              <p>Hi! This is Elva, director of global diversity and inclusion. Not only do we think that itâ€™s important for everyone to be fairly represented, but diverse teams produce better results. This is a platform where you can collaborate on interesting problems and develop new ideas together. Join us by selecting the ERGs that best represent your interests.</p>
              <%= link_to "Here's a link to my profile", '#' %>
            </div>
          </div>

        </div>
      </div>

      <div class="card">
        <div class="card__section">
          <%= simple_form_for resource, :as => resource_name, :url => invitation_path(resource_name), :html => { :method => :put } do |f| %>
            <%= devise_error_messages! %>
            <%= f.hidden_field :invitation_token %>

            <h2>Choose your ERG</h2>

            <% resource.enterprise.groups.each do |group| %>
              <div class="media-object" data-group-id="<%= group.id %>">
                <div class="flex-row">
                  <div class="flex-row__cell">
                    <%= image_tag group.logo.expiring_url(10, :medium) %>
                  </div>
                  <div class="flex-row__cell flex-row__cell--grow">
                    <h4><%= group.name %></h4>
                    <p><%= group.description %></p>
                  </div>
                </div>
              </div>
            <% end %>

            <%= f.input :first_name %>
            <%= f.input :last_name %>

            <% if !resource.enterprise.has_enabled_saml? %>
              <%= f.input :password %>
              <%= f.input :password_confirmation %>
            <% end %>

            <% resource.enterprise.fields.where(private: false).each do |cf| %>
              <%= render "shared/fields/display/custom_field", cf: cf, f: f, resource: resource %>
            <% end %>

            <%= f.button :submit, "Create my account", class: "btn--secondary btn--large btn--full" %>
          <% end %>
        </div>
      </div>
    </div>

    <script>
      $('.media-object').click(function() {
        $(this).toggleClass('media-object--selected');

        $('.group-id-field').remove();

        $('.media-object--selected').each(function() {
          var $hiddenField = $('<input type="hidden" name="user[group_ids][]" class="group-id-field"/>')
          $hiddenField.val($(this).data('group-id'));
          $('#edit_user').append($hiddenField);
        });
      });

      $('.select2').select2();
    </script>
  </div>

</body>
</html>