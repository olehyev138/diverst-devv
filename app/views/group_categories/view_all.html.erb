<div class="content__header">
	<h1>View All Categories</h1>
</div>
<p><%= link_to "Create Categories", new_group_category_url, class: "btn btn--primary" %></p>


<div class="content__main">
	<div class="card">
		<% @category_types.each do |category_type| %>
		<div class="card__section card__section--border">
			<div class="flex-row flex-row--middle">
				<div class="flex-row__cell flex-row__cell--grow">
					<h1 class="btn btn--primary"><span style="font-weight: bold;"><%= category_type %></span></h1>
					<%= link_to "+", add_category_group_category_type_url(category_type) %>
				</div>
				<div class="flex-row__cell flex-row__cell--grow">
				<%= link_to "Edit", [:edit, category_type] %>
				</div>
			</div> 
		</div>
		<% category_type.group_categories.each do |category| %>
		<div class="card__section card__section--border">
			<div class="flex-row flex-row--middle">
				<div class="flex-row__cell flex-row__cell--grow">
					<%= link_to "#{category}" + "(#{category.groups.count})", "#", class: "nested_show", id: category.id %>
					<%= link_to " hide Sub-#{c_t(:erg).titleize.pluralize} under #{category}", "#", class: "nested_hide", id: category.id, style: "display:none;" %>
				</div>
				<div class="flex-row__cell flex-row__cell--grow">
				<%= link_to "Edit", [:edit, category] %>
				</div>
			</div>
			<% category.groups.each do |group| %>
			<div class="groups_<%= category.id%>" style="display:none; position: relative; top: 10px;">
				<div class="flex-row flex-row--middle" style="margin-bottom: 10px;">
					<div class="flex-row__cell"></div>
					<div class="flex-row__cell">
						<p><%= image_tag group.logo.expiring_url(3600, :thumb), class: "avatar" %> <%= group.capitalize_name %></p>
					</div>
				</div>
			</div>
			<% end %>

		</div>
		<% end %>
		<% end %>
	</div>
</div>


<script>
	$('a.nested_show').click(function(e){
		var id = $(this).attr('id');
		$('div.groups_' + id).show();

		$(this).siblings('a.nested_hide').show();
		$(this).hide();
  }); //endof click

	$('a.nested_hide').click(function(e){
		var id = $(this).attr('id');
		$('div.groups_' + id).hide();
		$(this).siblings('a.nested_show').show();
		$(this).hide();
  }); //endof click
</script>