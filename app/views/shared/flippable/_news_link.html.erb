<% if news.link_type == "NewsLink" %>
  <% news_link = NewsLink.find(news.link.id) %>
  <div class="row block-section-news">
    <div class="col-xs-4">
      <% if news_link.photos.count > 0 %>
        <%= render partial: "shared/carousel/template", locals: {news_link: news_link } %>
      <% else %>
        <%= news_link_picture(news_link) %>
      <% end %>
    </div>
      <div class="col-xs-8">
      <div class="flex-row flex-row--middle">
        <div class="flex-row__cell flex-row__cell--grow">
            <%= link_to news_link.title, group_posts_url(news_link.group, anchor: "news_link_#{news_link.id}"), 'data-trackable': news_link.news_feed_link.id, class: 'underline_text' %>
            <br>
          <small><%= sanitize news_link.description.truncate(90) %></small><br>
          <small class="muted"><%= news_link.created_at.to_s :slashes %></small>
        </div>
      </div>
    </div>
    <%= render "groups/news_links/modal/form" %>
  </div>
<% elsif news.link_type === "GroupMessage" %>
  <div class="block block-section-news">
    <% message = GroupMessage.includes(:owner, :group).find(news.link.id) %>
    <div class="flex-row flex-row--middle">
      <div class="flex-row__cell flex-row__cell--grow">
        <span class="highlight"><%= link_to message.subject, group_group_message_path(message.group, message), class: "underline_text" %></span><br>
        <small><%= sanitize message.content.truncate(90) %></small><br>
        <small class="muted"><%= message.created_at.to_s :slashes %>
          <% if message.owner.present? %>
            by <%= message.owner.name_with_status %>
          <% end %>
        </small>
      </div>
      <div class="flex-row__cell">
        <span class="icon icon--chevron-right"></span>
      </div>
    </div>
  </div>
<% elsif news.link_type === "SocialLink" %>

  <% if news.link.url.include?("facebook") %>
      <iframe src="https://www.facebook.com/plugins/post.php?href=<%= news.link.url_safe %>&width=500&show_text=true&height=290&appId" width="500" height="290" style="border:none;overflow:hidden" scrolling="no" frameborder="0" allowTransparency="true"></iframe>
  <% elsif news.link.url.include?("instagram") %>
      <iframe width="320" height="440" src="<%= news.link.url %>embed" frameborder="0"></iframe>
  <% else %>
      <%= raw news.link.embed_code %>
  <% end %>

<% end %>

<script>
$(document).ready(function() {
  $('a[data-trackable]').click(function() {
      $.post('/views/track', { id: $(this).data('trackable') } );
  });
});
</script>
