<div class="content__main">
  <%= search_form_for @q, url: @q_form_submit_path, builder: SimpleForm::FormBuilder do |f| %>
    <div class="card">
      <div class="card__section card__section--border calendar-filters">
        <div class="row">
          <div class="col xs-5">
            <%= f.input :initiative_participating_groups_group_id_in,
                  as: :select,
                  collection: @groups,
                  input_html: { class: "select2", multiple: true, autofocus: true },
                  label: "Filter by #{ c_t(:erg) }",
                  required: false
            %>
          </div>
          <div class="col xs-5">
            <%= f.input :initiative_segments_segment_id_in,
                  as: :select,
                  collection: @segments,
                  input_html: { class: "select2-field-segments", multiple: true },
                  label: "Filter by #{ c_t(:segment) }",
                  required: false
            %>
          </div>
          <div class="col xs-2" style="padding-top: 15px;">
            <%= f.button :submit, value: "Filter" %>
          </div>
        </div>
      </div>
    </div>
  <% end %>

  <div class="card">
    <strong> Legend </strong>
    <br/>
    <% @groups.each do |group| %>
      <% if group.is_parent_group? %>
        <span class="" style="color: <%= to_color group.calendar_color %>;">
          <%= group.name %>
          <% unless group == @groups.last %>
            -
          <% end %>
        </span>
      <% elsif group.is_standard_group? %>
        <span class="" style="color: <%= to_color group.calendar_color %>;">
          <%= group.name %>
          <% unless group == @groups.last %>
            -
          <% end %>
        </span>
      <% end %>
    <% end %>
  </div>
</div>

<br/>

<div id="calendar" data-calendar-data-url="<%= calendar_data_groups_path(token: params[:token], q: params[:q]) %>"></div>

<%= render partial: 'shared/select2_ajax_search.js.erb' %>