<div class="content__header">
  <h1><%= @container.name %></h1>
  <div class="flex-row flex-row--middle">
    <div class="flex-row__cell hidden-xs">
      <%= link_to "Edit Folder", polymorphic_path(@container_path, action: "edit"), class: "btn btn--primary" if policy(@container).edit? %>
    </div>
    <div class="flex-row__cell hidden-xs">
      <%= link_to "+ Add folder", polymorphic_path([@container.container] + [:folder], folder_id: @container.id, action: "new"), class: "btn btn--primary" if policy(Folder).create? && @container.class.name === "Folder" %>
    </div>
    <div class="flex-row__cell hidden-xs">
      <%= link_to "+ Add resource", polymorphic_path(@container_path + [:resource], action: "new"), class: "btn btn--primary" if policy(Resource).new? %>
    </div>
  </div>
  <div class="container-fluid">
    <div class="row visible-xs text-center">
      <div class="col-xs-12">
        <div class="btn-group">
          <%= link_to "Edit Folder", polymorphic_path(@container_path, action: "edit"), class: "btn btn-primary" if policy(@container).edit? %>
          <%= link_to "+ Folder", polymorphic_path([@container.container] + [:folder], folder_id: @container.id, action: "new"), class: "btn btn-primary" if policy(Folder).create? && @container.class.name === "Folder" %>
          <%= link_to "+ Resource", polymorphic_path(@container_path + [:resource], action: "new"), class: "btn btn-primary" if policy(Resource).new? %>
        </div>
      </div>
    </div>
  </div>
</div>

<% if @container.class.name === "Folder" %>

  <div class="row">
    <% @container.children.each_with_index  do |folder, index| %>

      <div class="col-lg-3 col-md-4 col-sm-6 col-xs-12">
        <h4>
          <%= folder.name %>&nbsp;
          <% if folder.password_protected %>
            <span class="glyphicon glyphicon-lock" aria-hidden="true"></span>
          <% end %>
          &nbsp;<%= link_to "Delete", [@container.container] + [folder], method: :delete, class: "error", data: { confirm: "Are you sure?" } if policy(folder).destroy? %>
        </h4>
        <%= link_to inline_svg('icons/folder.svg', size: '100px*100px'), polymorphic_path([@container.container] + [folder] + [:resources]) if !folder.password_protected %>
        <%= link_to inline_svg('icons/folder.svg', size: '100px*100px'), [@container.container] + [folder], method: :get, remote: true if folder.password_protected %>
      </div>

    <% end %>
  </div>

  <%= render "shared/modal/form" %>

<% end %>

<%= render 'shared/resources/table' %>