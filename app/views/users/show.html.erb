<div class="content__header">
  <h1>User details</h1>
  <div class="flex-row flex-row--middle">
    <% if policy(@user).update? %>
      <div class="flex-row__cell">
        <%= link_to "Edit User", edit_user_path(@user), class: "btn btn--primary" %>
      </div>
    <% end %>
    <% if  @user.has_answered_group_surveys? %>
      <div class="flex-row__cell">
        <%= link_to c_t(:member_preference).pluralize, group_surveys_user_path(@user), class: "btn btn--secondary" %>
      </div>
    <% end %>
  </div>
</div>

<div class="content__main">

  <div class="card">
    <div class="card__section card__section--border">
      <label><strong>Name</strong></label>
      <p><%= @user.name %></p>
    </div>
    <div class="card__section card__section--border">
      <label><strong>Status</strong></label>
      <p><%= UserDecorator.decorate(@user).active_status %></p>
    </div>
    <div class="card__section card__section--border">
      <label><strong>Email</strong></label>
      <p><%= @user.email %></p>
    </div>
    <div class="card__section card__section--border">
      <label><strong>Biography</strong></label>
      <p><%= @user.biography %></p>
    </div>
    <div class="card__section card__section--border">
      <label><strong>Role</strong></label>
      <p><%= @user.user_role.role_name %></p>
    </div>
  </div>

  <% if policy(@user).access_hidden_info? %>
    <div class="card">
      <div class="card__section card__section--border">
        <h2>Hidden info</h2>
        <h4>Only D&I Management can see hidden fields</h4>
      </div>
      <% @user.enterprise.fields.where(private: false).each do |field| %>
        <div class="card__section card__section--border">
          <label><strong><%= field.title %></strong></label>
          <p><%= @user.string_for_field(field) %></p>
        </div>
      <% end %>
    </div>
  <% end %>

  <div class="card">
    <div class="card__section card__section--border" >
      <h2>Group Membership</h2>
      <h4>Member of the following <%= c_t(:erg) %>(s)</h4>
      <% @user.groups.each do |group| %>
        <%= group.name %>
        <% unless group == @user.groups.last %>
          ,
        <% end %>
      <% end %>
    </div>
  </div>

  <% if policy(@user).manage? %>
    <% policy_group = @user.policy_group %>

    <%= simple_form_for :policy_group, url: policy_group_template_path do |f| %>
      <div class="card">
        <div class="card__section card__section--border">
          <h2>User Permissions</h2>
        </div>
        <div class="card__section card__section--border">
          <h3>Enterprise</h3>
          <div class="row row--spacing-bottom">
            <div class="col md-3">
              <h4>Logs</h4>
              <%= f.input :logs_view, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "View", input_html: { checked: policy_group.logs_view } %>
            </div>

            <div class="col md-3">
              <h4>Permissions</h4>
              <%= f.input :permissions_manage, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Manage", input_html: { checked: policy_group.permissions_manage } %>
            </div>

            <div class="col md-3">
              <h4>SSO</h4>
              <%= f.input :sso_manage, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Manage", input_html: { checked: policy_group.sso_manage } %>
            </div>

            <div class="col md-3">
              <h4>Global Calendar</h4>
              <%= f.input :global_calendar, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "View", input_html: { checked: policy_group.global_calendar } %>
            </div>
          </div>
          <div class="row row--spacing-bottom">
            <div class="col md-3">
              <h4>Enterprise resources</h4>
              <%= f.input :enterprise_resources_index, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "View", input_html: { checked: policy_group.enterprise_resources_index } %>
              <%= f.input :enterprise_resources_create, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Create", input_html: { checked: policy_group.enterprise_resources_create } %>
              <%= f.input :enterprise_resources_manage, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Manage all", input_html: { checked: policy_group.enterprise_resources_manage } %>
            </div>

            <div class="col md-3">
              <h4>Diversity and Culture Index</h4>
              <%= f.input :diversity_manage, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Manage", input_html: { checked: policy_group.diversity_manage } %>
            </div>

            <div class="col md-3">
              <h4>Branding</h4>
              <%= f.input :branding_manage, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Manage", input_html: { checked: policy_group.branding_manage } %>
            </div>

            <div class="col md-3">
              <h4>Metrics dashboards</h4>
              <%= f.input :metrics_dashboards_index, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "View", input_html: { checked: policy_group.metrics_dashboards_index } %>
              <%= f.input :metrics_dashboards_create, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Create", input_html: { checked: policy_group.metrics_dashboards_create } %>
            </div>
          </div>
          <div class="row row--spacing-bottom">
            <div class="col md-3">
              <h4>Users</h4>
              <%= f.input :users_index, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "View", input_html: { checked: policy_group.users_index } %>
              <%= f.input :users_manage, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Manage", input_html: { checked: policy_group.users_manage } %>
            </div>
            <div class="col md-3">
              <h4><%= c_t(:segment).pluralize %></h4>
              <%= f.input :segments_index, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "View", input_html: { checked: policy_group.segments_index } %>
              <%= f.input :segments_create, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Create", input_html: { checked: policy_group.segments_create } %>
              <%= f.input :segments_manage, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Manage all", input_html: { checked: policy_group.segments_manage } %>
            </div>
            <div class="col md-3">
              <h4>Mentorship</h4>
              <%= f.input :mentorship_manage, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Manage", input_html: { checked: policy_group.mentorship_manage } %>
            </div>
          </div>
        </div>

        <div class="card__section card__section--border">
          <h3>General</h3>
          <div class="row row--spacing-bottom">
            <div class="col md-3">
              <h4>Campaigns</h4>
              <%= f.input :campaigns_index, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "View", input_html: { checked: policy_group.campaigns_index } %>
              <%= f.input :campaigns_create, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Create", input_html: { checked: policy_group.campaigns_create } %>
              <%= f.input :campaigns_manage, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Manage all", input_html: { checked: policy_group.campaigns_manage } %>
            </div>

            <div class="col md-3">
              <h4>Surveys</h4>
              <%= f.input :polls_index, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "View", input_html: { checked: policy_group.polls_index } %>
              <%= f.input :polls_create, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Create", input_html: { checked: policy_group.polls_create } %>
              <%= f.input :polls_manage, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Manage all", input_html: { checked: policy_group.polls_manage } %>
            </div>

            <div class="col md-3">
              <h4><%= c_t(:erg).pluralize %></h4>
              <%= f.input :groups_index, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "View", input_html: { checked: policy_group.groups_index } %>
              <%= f.input :groups_create, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Create", input_html: { checked: policy_group.groups_create } %>
              <%= f.input :groups_manage, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Manage all", input_html: { checked: policy_group.groups_manage } %>
            </div>
          </div>
        </div>

        <div class="card__section card__section--border">
          <h3><%= c_t(:erg) %> management</h3>
          <div class="row row--spacing-bottom">
            <div class="col md-3">
              <h4>Events</h4>
              <%= f.input :initiatives_index, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "View", input_html: { checked: policy_group.initiatives_index } %>
              <%= f.input :initiatives_create, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Create", input_html: { checked: policy_group.initiatives_create } %>
              <%= f.input :initiatives_manage, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Manage all", input_html: { checked: policy_group.initiatives_manage } %>
            </div>

            <div class="col md-3">
              <h4>Messages</h4>
              <%= f.input :group_messages_index, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "View", input_html: { checked: policy_group.group_messages_index } %>
              <%= f.input :group_messages_create, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Create", input_html: { checked: policy_group.group_messages_create } %>
              <%= f.input :group_messages_manage, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Manage all", input_html: { checked: policy_group.group_messages_manage } %>
            </div>

            <div class="col md-3">
              <h4>Members</h4>
              <%= f.input :groups_members_index, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "View", input_html: { checked: policy_group.groups_members_index } %>
              <%= f.input :groups_members_manage, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Manage", input_html: { checked: policy_group.groups_members_manage } %>
            </div>

            <div class="col md-3">
              <h4>Budgets</h4>
              <%= f.input :groups_budgets_index, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "View", input_html: { checked: policy_group.groups_budgets_index } %>
              <%= f.input :groups_budgets_request, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Request", input_html: { checked: policy_group.groups_budgets_request } %>
              <%= f.input :budget_approval, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Approval", input_html: { checked: policy_group.budget_approval } %>
              <%= f.input :groups_budgets_manage, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Manage", input_html: { checked: policy_group.groups_budgets_manage } %>
            </div>
          </div>
          <div class="row row--spacing-bottom">
            <div class="col md-3">
              <h4>News</h4>
              <%= f.input :news_links_index, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "View", input_html: { checked: policy_group.news_links_index } %>
              <%= f.input :news_links_create, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Create", input_html: { checked: policy_group.news_links_create } %>
              <%= f.input :news_links_manage, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Manage all", input_html: { checked: policy_group.news_links_manage } %>
            </div>

            <div class="col md-3">
              <h4>Leaders</h4>
              <%= f.input :group_leader_index, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "View", input_html: { checked: policy_group.group_leader_index } %>
              <%= f.input :group_leader_manage, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Manage", input_html: { checked: policy_group.group_leader_manage } %>
            </div>

            <div class="col md-3">
              <h4>Posts</h4>
              <%= f.input :group_posts_index, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "View", input_html: { checked: policy_group.group_posts_index } %>
              <%= f.input :manage_posts, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Manage", input_html: { checked: policy_group.manage_posts } %>
            </div>

            <div class="col md-3">
              <h4>Layouts</h4>
              <%= f.input :groups_layouts_manage, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Manage", input_html: { checked: policy_group.groups_layouts_manage } %>
            </div>
          </div>
          <div class="row row--spacing-bottom">
            <div class="col md-3">
              <h4>Settings</h4>
              <%= f.input :group_settings_manage, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Manage Group Settings", input_html: { checked: policy_group.group_settings_manage } %>
            </div>
            <div class="col md-3">
              <h4>Insights</h4>
              <%= f.input :groups_insights_manage, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Manage Group Insights", input_html: { checked: policy_group.groups_insights_manage } %>
            </div>
            <div class="col md-3">
              <h4>Social Links</h4>
              <%= f.input :social_links_index, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "View", input_html: { checked: policy_group.social_links_index } %>
              <%= f.input :social_links_create, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Create", input_html: { checked: policy_group.social_links_create } %>
              <%= f.input :social_links_manage, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Manage all", input_html: { checked: policy_group.social_links_manage } %>
            </div>
            <div class="col md-3">
              <h4>Resources</h4>
              <%= f.input :group_resources_index, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "View", input_html: { checked: policy_group.group_resources_index } %>
              <%= f.input :group_resources_create, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Create", input_html: { checked: policy_group.group_resources_create } %>
              <%= f.input :group_resources_manage, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Manage all", input_html: { checked: policy_group.group_resources_manage } %>
            </div>
          </div>
        </div>
      </div>
    <% end %>

    <% if @user.group_leaders.any? %>
      <% group_leader = @user.group_leaders.first %>

      <%= simple_form_for :group_leader, url: group_leaders_path(group_leader.group) do |f| %>
        <div class="card">
          <div class="card__section card__section--border">
            <h2>Group Leader Permissions</h2>
          </div>
          <div class="card__section card__section--border">
            <h3><%= c_t(:erg) %> management</h3>
            <div class="row row--spacing-bottom">
              <div class="col md-3">
                <h4>Events</h4>
                <%= f.input :initiatives_index, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "View", input_html: { checked: group_leader.initiatives_index } %>
                <%= f.input :initiatives_create, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Create", input_html: { checked: group_leader.initiatives_create } %>
                <%= f.input :initiatives_manage, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Manage all", input_html: { checked: group_leader.initiatives_manage } %>
              </div>

              <div class="col md-3">
                <h4>Messages</h4>
                <%= f.input :group_messages_index, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "View", input_html: { checked: group_leader.group_messages_index } %>
                <%= f.input :group_messages_create, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Create", input_html: { checked: group_leader.group_messages_create } %>
                <%= f.input :group_messages_manage, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Manage all", input_html: { checked: group_leader.group_messages_manage } %>
              </div>

              <div class="col md-3">
                <h4>Members</h4>
                <%= f.input :groups_members_index, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "View", input_html: { checked: group_leader.groups_members_index } %>
                <%= f.input :groups_members_manage, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Manage", input_html: { checked: group_leader.groups_members_manage } %>
              </div>

              <div class="col md-3">
                <h4>Budgets</h4>
                <%= f.input :groups_budgets_index, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "View", input_html: { checked: group_leader.groups_budgets_index } %>
                <%= f.input :groups_budgets_request, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Request", input_html: { checked: group_leader.groups_budgets_request } %>
                <%= f.input :budget_approval, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Approval", input_html: { checked: group_leader.budget_approval } %>
                <%= f.input :groups_budgets_manage, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Manage", input_html: { checked: group_leader.groups_budgets_manage } %>
              </div>
            </div>
            <div class="row row--spacing-bottom">
              <div class="col md-3">
                <h4>News</h4>
                <%= f.input :news_links_index, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "View", input_html: { checked: group_leader.news_links_index } %>
                <%= f.input :news_links_create, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Create", input_html: { checked: group_leader.news_links_create } %>
                <%= f.input :news_links_manage, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Manage all", input_html: { checked: group_leader.news_links_manage } %>
              </div>

              <div class="col md-3">
                <h4>Leaders</h4>
                <%= f.input :group_leader_index, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "View", input_html: { checked: group_leader.group_leader_index } %>
                <%= f.input :group_leader_manage, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Manage", input_html: { checked: group_leader.group_leader_manage } %>
              </div>

              <div class="col md-3">
                <h4>Posts</h4>
                <%= f.input :group_posts_index, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "View", input_html: { checked: group_leader.group_posts_index } %>
                <%= f.input :manage_posts, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Manage", input_html: { checked: group_leader.manage_posts } %>
              </div>

              <div class="col md-3">
                <h4>Layouts</h4>
                <%= f.input :groups_layouts_manage, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Manage", input_html: { checked: group_leader.groups_layouts_manage } %>
              </div>
            </div>
            <div class="row row--spacing-bottom">
              <div class="col md-3">
                <h4>Settings</h4>
                <%= f.input :group_settings_manage, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Manage Group Settings", input_html: { checked: group_leader.group_settings_manage } %>
              </div>
              <div class="col md-3">
                <h4>Insights</h4>
                <%= f.input :groups_insights_manage, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Manage Group Insights", input_html: { checked: group_leader.groups_insights_manage } %>
              </div>
              <div class="col md-3">
                <h4>Social Links</h4>
                <%= f.input :social_links_index, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "View", input_html: { checked: group_leader.social_links_index } %>
                <%= f.input :social_links_create, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Create", input_html: { checked: group_leader.social_links_create } %>
                <%= f.input :social_links_manage, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Manage all", input_html: { checked: group_leader.social_links_manage } %>
              </div>
              <div class="col md-3">
                <h4>Resources</h4>
                <%= f.input :group_resources_index, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "View", input_html: { checked: group_leader.group_resources_index } %>
                <%= f.input :group_resources_create, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Create", input_html: { checked: group_leader.group_resources_create } %>
                <%= f.input :group_resources_manage, as: :boolean, required: false, disabled: true, wrapper: :boolean_checkbox, label: "Manage all", input_html: { checked: group_leader.group_resources_manage } %>
              </div>
            </div>
          </div>
        </div>
      <% end %>
    <% end %>
  <% end %>
</div>
